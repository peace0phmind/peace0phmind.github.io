<!doctype html><html lang=zh-cn data-theme=dark><head><meta charset=utf-8><meta name=viewport content="width=device-width"><meta name=theme-color content="#222" media="(prefers-color-scheme: dark)"><meta name=generator content="Hugo 0.105.0"><link rel="shortcut icon" type=image/x-icon href=/images/icons/favicon.ico><link rel=icon type=image/x-icon href=/images/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/images/icons/favicon_16x16_next.png><link rel=icon type=image/png sizes=32x32 href=/images/icons/favicon_32_32_next.png><link rel=apple-touch-icon sizes=180x180 href=/images/icons/apple_touch_icon_next.png><meta itemprop=name content="Classification"><meta itemprop=description content="classification"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="https://peace0phmind.github.io/images/avatar.png"><meta itemprop=keywords content="classification"><meta property="og:type" content="article"><meta property="og:title" content="Classification"><meta property="og:description" content="classification"><meta property="og:image" content="/images/avatar.png"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="https://peace0phmind.github.io/posts/202211/03-classification/"><meta property="og:site_name" content="Mind's Home"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="peace0phmind"><meta property="article:published_time" content="2022-11-08 14:59:57 +0800 +0800"><meta property="article:modified_time" content="2022-11-08 14:59:57 +0800 +0800"><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/font-awesome/6.1.2/css/all.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.css><link rel=stylesheet href=/css/main.min.944e76d4060fb050b15213841e33f45340ed65ad742405881cb5e7824000d0a9.css><style type=text/css>.post-footer{content:"~ 我可是有底线的哟 ~"}</style><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return void 0;const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),void 0):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){console.log("aaaa hello world!");const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script class=next-config data-name=page type=application/json>{"comments":false,"isHome":false,"isPage":true,"path":"03-classification","permalink":"https://peace0phmind.github.io/posts/202211/03-classification/","title":"Classification","waline":{"js":[{"alias":"waline","alias_name":"@waline/client","file":"dist/pageview.js","name":"pageview","version":"2.13.0"},{"alias":"waline","alias_name":"@waline/client","file":"dist/comment.js","name":"comment","version":"2.13.0"}]}}</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>Classification - Mind's Home</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label=切换导航栏 role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>Mind's Home</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>Notebook</p></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-about"><a href=/about.html class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><a href=#probabilistic-generative-model>Probabilistic Generative Model</a><ul><li><a href=#features-and-predict-target>features and predict target</a></li><li><a href=#how-to-do-classification>How to do Classification</a></li><li><a href=#classification-as-regression分类问题是否可以用回归算法处理>Classification as Regression?（分类问题是否可以用回归算法处理？）</a></li><li><a href=#ideal-alternatives理想的做法>Ideal Alternatives(理想的做法)</a></li><li><a href=#generative-model>Generative Model</a></li><li><a href=#gaussian-distribution>Gaussian Distribution</a></li><li><a href=#maximum-likelihood找meanmu和covariance-matrix-sigma的方法>Maximum Likelihood（找mean$\mu$和covariance matrix $\Sigma$的方法）</a></li><li><a href=#采用上诉方法得到的测试结果>采用上诉方法得到的测试结果</a></li><li><a href=#modifying-model-ref-bishop-chapter-422>Modifying Model (Ref: Bishop chapter 4.2.2)</a><ul><li><a href=#模型修改后如何计算mu和sigma>模型修改后如何计算$\mu$和$\Sigma$</a></li><li><a href=#模型修改后画出的图形>模型修改后画出的图形</a></li></ul></li><li><a href=#总结一下3个步骤>总结一下3个步骤</a></li><li><a href=#probability-distribution>Probability Distribution</a></li><li><a href=#posterior-probability>Posterior Probability</a><ul><li><a href=#求z>求z</a></li><li><a href=#求-sigmaz>求 $\sigma(z)$</a></li></ul></li></ul></li><li><a href=#reference-video>reference video</a></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=peace0phmind src=/images/img-lazy-loading.gif data-src=/images/avatar.png><p class=site-author-name itemprop=name>peace0phmind</p><div class=site-description itemprop=description></div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/posts/><span class=site-state-item-count>30</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>2</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>9</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/peace0phmind title="Github → https://github.com/peace0phmind" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>Github</a></span></div></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate=2020-10-20T19:37:14+08:00></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>总访客数：</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>页面浏览：</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count=26138></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times=69></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate=2022-11-10T09:09:34+08:00></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-gtranslate class=button title=多语言翻译><i class="fas fa-globe"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a>
<a href=https://github.com/peace0phmind rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://peace0phmind.github.io/posts/202211/03-classification/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/images/avatar.png"><meta itemprop=name content="peace0phmind"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="peace0phmind"><meta itemprop=description content></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="Classification"><meta itemprop=description content="classification"></span><header class=post-header><h1 class=post-title itemprop="name headline">Classification
<a href=https://github.com/peace0phmind/peace0phmind.github.io/tree/master/content/posts/202211/03-classification.md rel="noopener external nofollow noreferrer" target=_blank class="exturl post-edit-link" title=编辑><i class="fa fa-pen-nib"></i></a></h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i></span>
<span class=post-meta-item-text>发表于：</span>
<time title="发表于：2022-11-08 14:59:57 +0800 +0800" itemprop="dateCreated datePublished" datetime="2022-11-08 14:59:57 +0800 +0800">2022-11-08</time></span>
<span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-folder-open"></i></span>
<span class=post-meta-item-text>分类于：</span>
<span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/machine-learning itemprop=url rel=index><span itemprop=name>machine-learning</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="far fa-file-word"></i></span>
<span class=post-meta-item-text>字数：</span><span>2014</span></span>
<span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="far fa-clock"></i></span>
<span class=post-meta-item-text>阅读：&ap;</span>
<span>5分钟</span></span>
<span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="far fa-eye"></i></span>
<span class=post-meta-item-text>浏览：</span>
<span id=busuanzi_value_page_pv class=waline-pageview-count data-path=/posts/202211/03-classification/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class="post-body autonumber" itemprop=articleBody><p><code>Classification</code>: Given options(classes), the function outputs the correct one.</p><h2 id=probabilistic-generative-model>Probabilistic Generative Model</h2><h3 id=features-and-predict-target>features and predict target</h3><ul><li>一共有7个features，其中</li><li><code>Total</code> = <code>HP</code> + <code>Attack</code> + <code>Deffense</code> + <code>SP Atk</code> + <code>Sp Def</code> + <code>Speed</code></li><li>predict target: type of pokemon</li></ul><p><figure><img data-zoomable src=/images/img-lazy-loading.gif data-src=/images/202211/03-classification/4.004.jpg alt="features and predict target" title="features and predict target"><figcaption>features and predict target</figcaption></figure></p><h3 id=how-to-do-classification>How to do Classification</h3><ul><li>收集Training data for Classification</li><li>考虑如果做分类？</li></ul><h3 id=classification-as-regression分类问题是否可以用回归算法处理>Classification as Regression?（分类问题是否可以用回归算法处理？）</h3><p>以二分类举个例子</p><ul><li>Training: Class 1 means the target is 1; Class 2 means the target is -1</li><li>Testing: $ \text{closer to 1} \rightarrow \text{class 1}; \text{closer to -1} \rightarrow \text{class 2} $</li></ul><p>这样直接用Regression来解决Classification的问题，会发生如下图的情况：</p><ul><li>当样本feature如左图所示，则$y=b+w_1x_1+w_2x_2$的函数可以很好的工作。</li><li>当样本feature如右图所示，由于右下角的数据，导致Regression的Loss函数在求最小值时，会倾向于给出紫色的线段的方程。即Loss函数会由于“太正确”而导致最终预测结果出错。</li><li>Penalize to the examples that are &ldquo;too correct&rdquo; &mldr; (Bishop, P186)</li></ul><p><figure><img data-zoomable src=/images/img-lazy-loading.gif data-src=/images/202211/03-classification/4.007.jpg alt="Classification as Regression" title="Classification as Regression"><figcaption>Classification as Regression</figcaption></figure></p><h3 id=ideal-alternatives理想的做法>Ideal Alternatives(理想的做法)</h3><ul><li>Function (Model):
$$ \delta(x) \Rightarrow \begin{cases} g(x) > 0 & \text{Output = class 1} \cr else & \text{Output = class 2} \end{cases} $$</li><li>Loss Function<ul><li>The number of times f get incorrect results on training data.
$$ L(f) = \sum_n\delta(f(x^n) \ne \hat{y}^n ) $$</li></ul></li><li>Find the best function:<ul><li>Example: Perceptron, SVM</li></ul></li></ul><h3 id=generative-model>Generative Model</h3><ul><li>$P(C_1)$是从两个分类中，随机选中Class1的几率，$P(C_2)$是从两个分类中，随机选中Class2的几率。</li><li>假设x为其中一种颜色的圆圈，则：$P(x|C_1)$表示从Class1中选中x的几率，$P(x|C_2)$表示从Class2中选中x的几率，</li><li>选中x属于class1的几率就是：$ P(C_1|x) = \frac{P(C_1)P(x|C_1)}{P(C_1)P(x|C_1)+P(C_2)P(x|C_2)} $</li><li>选中x的总几率就是： $ P(x) = P(x|C_1)P(C_1) + P(x|C_2)P(C_2) $</li><li>Estimating the Probabilities From training data, 这整个想法就叫做<span style=color:red>Generative Model</span></li></ul><p><figure><img data-zoomable src=/images/img-lazy-loading.gif data-src=/images/202211/03-classification/4.010.jpg alt="Generative Model" title="Generative Model"><figcaption>Generative Model</figcaption></figure></p><h3 id=gaussian-distribution>Gaussian Distribution</h3><ul><li>$ f_{\mu,\sum}(x) = \frac{1}{(2\pi)^{D/2}}\frac{1}{|\sum|^{1/2}} exp \{ -\frac{1}{2}(x-\mu)^T\sum^{-1}(x-\mu) \} $</li><li>input: vector x, output: probability of sampling x(实际是probability density，概率密度与概率成正比,此处简略为概率)</li><li>The shape of the function determines by <span style=color:red>mean $\mu$</span> and <span style=color:red>covariance matrix $\sum$</span>(协方差矩阵)</li></ul><p><figure><img data-zoomable src=/images/img-lazy-loading.gif data-src=/images/202211/03-classification/4.014.jpg alt="Gaussian Distribution" title="Gaussian Distribution"><figcaption>Gaussian Distribution</figcaption></figure></p><h3 id=maximum-likelihood找meanmu和covariance-matrix-sigma的方法>Maximum Likelihood（找mean$\mu$和covariance matrix $\Sigma$的方法）</h3><ul><li>mean $\mu$控制原点的位置。</li><li>covariance matrix $\Sigma$决定图形的形状。</li><li>虽然图中左下角的点都可以求出相对于两个圈的概率，但是这两个概率的大小是不一样的。</li><li>给定一个Gaussian的$\mu$和$\Sigma$,就可以求出对应的Likelihood:<ul><li>$ L(\mu, \Sigma) = f_{\mu, \Sigma}(x^1)f_{\mu, \Sigma}(x^2)f_{\mu, \Sigma}(x^3)\dots\dots f_{\mu, \Sigma}(x^n) $</li><li>这里的每一个$f_{\mu, \Sigma}(x^1)$展开，都是$ f_{\mu,\sum}(x) = \frac{1}{(2\pi)^{D/2}}\frac{1}{|\sum|^{1/2}} exp \{ -\frac{1}{2}(x-\mu)^T\sum^{-1}(x-\mu) \} $</li></ul></li><li>Maximum Likelihood: $ \mu^*, \Sigma^* = arg \max\limits_{\mu, \Sigma} L(\mu, \Sigma) $<ul><li>$\mu^*$为取x的平均值: $ \mu^* = \frac{1}{n}\sum\limits_{i=1}^n x^i $</li><li>$ \Sigma^* = \frac{1}{n} \sum\limits_{i=1}^n(x^i-\mu^*)(x^i-\mu^*)^T $</li></ul></li></ul><p><figure><img data-zoomable src=/images/img-lazy-loading.gif data-src=/images/202211/03-classification/4.017.jpg alt="Maximum Likelihood" title="Maximum Likelihood"><figcaption>Maximum Likelihood</figcaption></figure></p><h3 id=采用上诉方法得到的测试结果>采用上诉方法得到的测试结果</h3><table><thead><tr><th>features</th><th>$\theta$</th><th>test accuracy</th></tr></thead><tbody><tr><td><code>Defense</code>,<code>SP Defense</code></td><td>$ \mu^1, \mu^2 $ : 2-dim vector<br>$\Sigma^1, \Sigma^2$: 2*2 matrices</td><td>47%</td></tr><tr><td>All the 7 features</td><td>$ \mu^1\dots\mu^7 $ : 7-dim vector<br>$\Sigma^1\dots\Sigma^7$: 7*7 matrices</td><td>54%</td></tr></tbody></table><span style=color:red>结果不理想，需要重新调整模型。</span><h3 id=modifying-model-ref-bishop-chapter-422>Modifying Model (Ref: Bishop chapter 4.2.2)</h3><ul><li>给每一个Gaussian有一个自己的$\mu$和自己的covariance matrix $\Sigma$是很少见的</li><li>常见的做法是，不同的Class对应的Gaussian可以share相同的covariance matrix $\Sigma$</li></ul><p><figure><img data-zoomable src=/images/img-lazy-loading.gif data-src=/images/202211/03-classification/4.022.jpg alt="Share Covariance matrix" title="Share Covariance matrix"><figcaption>Share Covariance matrix</figcaption></figure></p><h4 id=模型修改后如何计算mu和sigma>模型修改后如何计算$\mu$和$\Sigma$</h4><ul><li>假设有数量为n的class1,数量为m的class2</li><li>likelihood: \begin{align} L(\mu^1, \mu^2, \Sigma) = & f_{\mu^1, \Sigma}(x^1)f_{\mu^1, \Sigma}(x^2)\dots\dots f_{\mu^1, \Sigma}(x^n) \cr \times &f_{\mu^2, \Sigma}(x^{n+1})f_{\mu^2, \Sigma}(x^{n+2})\dots\dots f_{\mu^2, \Sigma}(x^{n+m}) \end{align}</li><li>如下图， $\mu^1$, $\mu^2$和原来一样计算: \begin{align} \mu^1 & = \frac{1}{n}\sum\limits_{i=1}^n x^i \cr \mu^2 & = \frac{1}{m}\sum\limits_{i=1}^m x^i \end{align}</li><li>$\Sigma^*$的计算修改为：$ \Sigma = \frac{n}{n+m}\Sigma^1 + \frac{m}{n+m}\Sigma^2 $</li></ul><p><figure><img data-zoomable src=/images/img-lazy-loading.gif data-src=/images/202211/03-classification/4.023.jpg alt=Compute title=Compute><figcaption>Compute</figcaption></figure></p><h4 id=模型修改后画出的图形>模型修改后画出的图形</h4><ul><li>从原来的曲线，变成了一条直线</li><li>由于边界(boundary)是一条直线，所以这种模型也叫做Linear Model。</li><li><span style=color:green>在这个模型下，考虑所有的7个features进行计算，则accuracy从原来的54%上升到73%</span></li></ul><h3 id=总结一下3个步骤>总结一下3个步骤</h3><ul><li>Function Set(Model):
\begin{align} P(C_1|x) &= \frac{P(C_1)P(x|C_1)}{P(C_1)P(x|C_1)+P(C_2)P(x|C_2)} \cr
& \begin{cases} \text{if} P(C_1|x) > 0.5 & \text{, output: class 1} \cr Otherwise & \text{, output: class 2} \end{cases}
\end{align}</li><li>Goodness of a function:<ul><li>The mean $\mu$ and covariance $\Sigma$ that maximizing the likelihood(the probability of generating data)</li></ul></li><li>Find the best function: easy</li></ul><h3 id=probability-distribution>Probability Distribution</h3><ul><li>You can always use the distribution you like</li><li>假设$P(x|C^1)$构成Class1的x有K个，且K个x想对于Class1的几率是独立的，则：$ P(x|C1) = P(x_1|C_1)P(x_2|C_1)\cdots P(x_K|C_1) $，这个会得到1-D Gaussian,参数会进一步简化</li><li>For binary features, you may assume they are from <code>Bernouli distributions</code>.</li><li>If you assume all the dimensions are independent, then you are using <code>Naive Bayes Classifier</code>.</li></ul><h3 id=posterior-probability>Posterior Probability</h3><ul><li>设有表达式(1)上下同时除上表达式$ P(C_1)P(x|C_1) $得到表达式(2)</li><li>设$ z = ln\frac{P(C_1)P(x|C_1)}{P(C_2)P(x|C_2)} $,则表达式(2)变为表达式(3)</li><li>表达式(3)和(4)等价，为<code>Sigmoid Function</code>
\begin{align}
P(C_1|x) &= \frac{P(C_1)P(x|C_1)}{P(C_1)P(x|C_1)+P(C_2)P(x|C_2)} \tag{1} \cr
&= \frac{1}{1+\frac{P(C_2)P(x|C_2)}{P(C_1)P(x|C_1)}} \tag{2} \cr
&= \frac{1}{1 + exp^{-z}} \tag{3} \cr
&= \sigma(z) \tag{4}
\end{align}</li></ul><h4 id=求z>求z</h4><ul><li>设$N_1$是Class1出现的次数，$N_2$是Class2出现的次数</li><li>表达式(3)和(4)为Gaussian的Distribution</li><li>表达式(5)上下同时除以$\frac{1}{(2\pi)^{D/2}}$得到表达式(6)
\begin{align}
z &= ln\frac{P(C_1)P(x|C_1)}{P(C_2)P(x|C_2)} \cr
&= ln\frac{P(C_1)}{P(C_2)} + ln\frac{P(x|C_1)}{P(x|C_2)} \tag{1} \cr
ln\frac{P(C_1)}{P(C_2)} &=\frac{\frac{N_1}{N_1+N_2}}{\frac{N_2}{N_1+N_2}} = \frac{N_1}{N_2} \tag{2} \cr
P(x|C_1) &= \frac{1}{(2\pi)^{D/2}}\frac{1}{|\Sigma^1|^{1/2}} exp \{ -\frac{1}{2}(x-\mu^1)^T(\Sigma^1)^{-1}(x-\mu^1) \} \tag{3} \cr
P(x|C_2) &= \frac{1}{(2\pi)^{D/2}}\frac{1}{|\Sigma^2|^{1/2}} exp \{ -\frac{1}{2}(x-\mu^2)^T(\Sigma^2)^{-1}(x-\mu^2) \} \tag{4} \cr<br>ln\frac{P(x|C_1)}{P(x|C_2)} &= ln\frac{\frac{1}{(2\pi)^{D/2}}\frac{1}{|\Sigma^1|^{1/2}} exp \{ -\frac{1}{2}(x-\mu^1)^T(\Sigma^1)^{-1}(x-\mu^1) \}}
{\frac{1}{(2\pi)^{D/2}}\frac{1}{|\Sigma^2|^{1/2}} exp \{ -\frac{1}{2}(x-\mu^2)^T(\Sigma^2)^{-1}(x-\mu^2) \}} \tag{5} \cr
&= ln\frac{\frac{1}{|\Sigma^1|^{1/2}} exp \{ -\frac{1}{2}(x-\mu^1)^T(\Sigma^1)^{-1}(x-\mu^1) \}}
{\frac{1}{|\Sigma^2|^{1/2}} exp \{ -\frac{1}{2}(x-\mu^2)^T(\Sigma^2)^{-1}(x-\mu^2) \}} \tag{6} \cr
&= ln\frac{|\Sigma^2|^{1/2}}{|\Sigma^1|^{1/2}}exp \{ -\frac{1}{2}[(x-\mu^1)^T(\Sigma^1)^{-1}(x-\mu^1) - (x-\mu^2)^T(\Sigma^2)^{-1}(x-\mu^2)] \} \tag{7} \cr
&= ln\frac{|\Sigma^2|^{1/2}}{|\Sigma^1|^{1/2}} - \frac{1}{2}[(x-\mu^1)^T(\Sigma^1)^{-1}(x-\mu^1) - (x-\mu^2)^T(\Sigma^2)^{-1}(x-\mu^2)] \tag{8} \cr
(x-\mu^1)^T(\Sigma^1)^{-1}(x-\mu^1) &= x^T(\Sigma^1)^{-1}x - x^T(\Sigma^1)^{-1}\mu^1 - (\mu^1)^T(\Sigma^1)^{-1}x + (\mu^1)^T(\Sigma^1)^{-1}\mu^1 \cr
&= x^T(\Sigma^1)^{-1}x - 2(\mu^1)^T(\Sigma^1)^{-1}x + (\mu^1)^T(\Sigma^1)^{-1}\mu^1 \cr
(x-\mu^2)^T(\Sigma^2)^{-1}(x-\mu^2) &= x^T(\Sigma^2)^{-1}x - 2(\mu^2)^T(\Sigma^2)^{-1}x + (\mu^2)^T(\Sigma^2)^{-1}\mu^2 \cr
z &= ln\frac{|\Sigma^2|^{1/2}}{|\Sigma^1|^{1/2}} - \frac{1}{2}x^T(\Sigma^1)^{-1}x + (\mu^1)^T(\Sigma^1)^{-1}x - \frac{1}{2}(\mu^1)^T(\Sigma^1)^{-1}\mu^1 \cr
&+ \frac{1}{2}x^T(\Sigma^2)^{-1}x - (\mu^2)^T(\Sigma^2)^{-1}x + \frac{1}{2}(\mu^2)^T(\Sigma^2)^{-1}\mu^2 + ln\frac{N_1}{N_2}
\end{align}</li></ul><h4 id=求-sigmaz>求 $\sigma(z)$</h4><ul><li>当$ \Sigma_1 = \Sigma_2 = \Sigma $时，表达式(1)变为表达式(2)</li><li>设: $ w^T = (\mu_1 - \mu_2)^T\Sigma^{-1} $以及$ b = -\frac{1}{2}(\mu^1)^T(\Sigma^1)-1\mu^1 + \frac{1}{2}(\mu^2)^T(\Sigma^2)-1\mu^2 + ln\frac{N_1}{N_2} $则(2)可以推导为(3)</li><li>In generative model, we estimate $ N_1, N_2, \mu^1, \mu^2, \Sigma $, then we have w and b.
\begin{align}
z &= ln\frac{|\Sigma^2|^{1/2}}{|\Sigma^1|^{1/2}} - \frac{1}{2}x^T(\Sigma^1)^{-1}x + (\mu^1)^T(\Sigma^1)^{-1}x - \frac{1}{2}(\mu^1)^T(\Sigma^1)^{-1}\mu^1 \cr
&+ \frac{1}{2}x^T(\Sigma^2)^{-1}x - (\mu^2)^T(\Sigma^2)^{-1}x + \frac{1}{2}(\mu^2)^T(\Sigma^2)^{-1}\mu^2 + ln\frac{N_1}{N_2} \tag{1}\cr
&= (\mu_1 - \mu_2)^T\Sigma^{-1}x -\frac{1}{2}(\mu^1)^T(\Sigma^1)-1\mu^1 + \frac{1}{2}(\mu^2)^T(\Sigma^2)-1\mu^2 + ln\frac{N_1}{N_2} \tag{2}\cr
&= w \cdot x + b \tag{3} \cr
P(C_1|x) &= \sigma(z) \cr &= \sigma(w \cdot x + b)
\end{align}</li></ul><span style=color:red>How about directly find w and b?</span><h2 id=reference-video>reference video</h2><p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/fZAZUYEeIMg style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/hSXFuypLukA style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></p></div><footer class=post-footer><div class=post-tags><a href=/tags/classification>classification</a></div><div class=addthis_inline_share_toolbox style=text-align:center></div><hr><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/posts/202211/ghostscript/ rel=next title="Using Ghostscript"><i class="fa fa-chevron-left"></i> Using Ghostscript</a></div><div class="post-nav-prev post-nav-item"><a href=/posts/202211/02-regression/ rel=prev title=Regression>Regression
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div></main><footer class=footer><div class=footer-inner><div id=gtranslate class=google-translate><i class="fa fa-language"></i><div id=google_translate_element></div></div><div class=copyright>&copy;
<span itemprop=copyrightYear>2010 - 2022</span>
<span class=with-love><i class="fa fa-heart"></i></span>
<span class=author itemprop=copyrightHolder>peace0phmind</span></div></div></footer><script type=text/javascript src=https://cdn.staticfile.org/animejs/3.2.1/anime.min.js defer></script>
<script type=text/javascript src=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.js defer></script>
<script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"busuanzi":{"pageview":true},"copybtn":true,"darkmode":true,"giscus":{"cfg":{"category":"Comments","categoryid":null,"emit":false,"inputposition":"top","mapping":"title","reactions":false,"repo":"username/repo-name","repoid":null,"theme":"preferred_color_scheme"},"js":"https://giscus.app/client.js"},"hostname":"https://peace0phmind.github.io","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"lang":"zh-CN","lazyload":false,"localSearch":{"enable":true,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"root":"/","scheme":"Gemini","sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"statis":{"enable":true,"plugin":"busuanzi"},"vendor":{"plugins":"qiniu","router":"https://cdn.staticfile.org"},"version":"4.4.0","waline":{"cfg":{"comment":true,"emoji":false,"imguploader":false,"pageview":true,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"serverurl":null,"sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"waline","file":"dist/waline.css","name":"@waline/client","version":"2.13.0"},"js":{"alias":"waline","file":"dist/waline.js","name":"@waline/client","version":"2.13.0"}}}</script><script type=text/javascript src=/js/main.min.c000895f35c4f549795bbb87a678888fa0246f9513d456814f0988441a9a4b7c.js defer></script>
<script src=https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin=anonymous></script>
<script type=text/javascript>mediumZoom("[data-zoomable]",{background:null})</script><script type=text/javascript>window.MathJax={options:{ignoreHtmlClass:"markmap"},tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!1,packages:{"[+]":["base","extpfeil","ams","amscd","newcommand","knowl","sfrac"]}},chtml:{},loader:{load:["input/asciimath","[tex]/extpfeil","[tex]/amscd","[tex]/newcommand","[pretext]/mathjaxknowl3.js"],paths:{pretext:"https://pretextbook.org/js/lib"}},startup:{ready(){const e=MathJax._.input.tex.Configuration.Configuration,t=MathJax._.input.tex.SymbolMap.CommandMap;new t("sfrac",{sfrac:"SFrac"},{SFrac(e,t){const n=e.ParseArg(t),s=e.ParseArg(t),o=e.create("node","mfrac",[n,s],{bevelled:!0});e.Push(o)}}),e.create("sfrac",{handler:{macro:["sfrac"]}}),MathJax.startup.defaultReady()}}}</script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js integrity crossorigin=anonymous></script></body></html>